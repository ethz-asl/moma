<?xml version="1.0"?>
<launch>
    <arg name="standalone" default="false"/>

    <!-- Control -->
    <include file="$(find smb_control)/launch/smb_control.launch">
        <arg name="description_name"        value="smb_description"/>
        <arg name="control_namespace"       value="smb"/>
        <arg name="robot_namespace"         value=""/>
        <arg name="enable_ekf"              value="false" /> <!-- we cannot use ekf when localization through icp -->
        <arg name="simulation"              value="false"/>
        <arg name="mpc"                     value="false"/>
        <arg name="publish_robot_state"     value="false"/>  <!-- Since we do this in the current launch for the full robot -->
    </include>
  
    <!-- Sensors -->
    <include file="$(find smb)/launch/sensors.launch">
      <arg name="launch_versavis"       value="true"/>
      <arg name="launch_depth_cam"      value="false"/>
      <arg name="launch_tracking_cam"   value="true"/>
    </include>
  
    <!-- Low level smb controller -->
    <include file="$(find smb_lowlevel_controller)/launch/smb_lowlevel_controller.launch" ns="smb">
	  <arg name="description_name"            value="/smb_description"/>
	  <arg name="command_smb"                 value="true"/>
  </include>

  <!-- When we want to run the smb without the arm, we need the robot description and dummy state publishing -->
  <group if=$(arg standalone)>
    <param name="robot_description" command="$(find xacro)/xacro $(find moma_description)/urdf/superpanda.urdf.xacro 
      use_nominal_extrinsics:=true use_fixed_realsense:=false tool:='none'"/>
    <node name="joint_state_publisher" type="joint_state_publisher" pkg="joint_state_publisher" output="screen"/>
    <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" output="screen"/>
  </group>
</launch>
