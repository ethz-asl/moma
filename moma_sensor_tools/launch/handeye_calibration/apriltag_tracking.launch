<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="launch_apriltag"   default="true"/>
  <arg name="launch_kinect"     default="true"/>
  <arg name="launch_prefix"     default="" />
  <arg name="camera_name"       default="kinect" />
  <arg name="image_domain"      default="rgb" />
  <arg name="enable_depth"      default="true"/>
  <arg name="debug_pcl"         default="false"/>
  <arg name="rviz"              default="false"/>

  <!-- image_proc node to publish rectified image -->
  <node name="image_proc" pkg="image_proc" type="image_proc" ns="/$(arg camera_name)/$(arg image_domain)"/>

  <!-- apriltag detection node -->
  <node pkg="apriltag_ros" type="apriltag_ros_continuous_node" name="apriltag_ros" clear_params="true" output="screen" launch-prefix="$(arg launch_prefix)" if="$(arg launch_apriltag)" >

    <!-- Remap topics from those used in code to those on the ROS network -->
    <remap from="/camera_info" to="/$(arg camera_name)/$(arg image_domain)/camera_info" />
    <remap from="/image_rect" to="/$(arg camera_name)/$(arg image_domain)/image_rect" />

    <param name="camera_frame" value="$(arg camera_name)_color_optical_frame" />
    <param name="publish_tag_detections_image" type="bool" value="true" />      <!-- default: false -->
    <rosparam command="load" file="$(find moma_sensor_tools)/config/handeye_calibration/apriltag_settings.yaml"/>
    <rosparam command="load" file="$(find moma_sensor_tools)/config/handeye_calibration/apriltags.yaml"/>
  </node>

  <!-- Rviz helper visualization -->
  <node pkg="rviz" type="rviz" name="$(anon rviz)" args="-d $(find moma_sensor_tools)/config/rviz/hand_eye.rviz" if="$(arg rviz)"/>
</launch>
